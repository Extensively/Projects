<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" type="image/gif" href="https://extensively.github.io/Projects/img/roach.gif">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Shapez V1.5.4</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body style="color: #FFFFFF;">
<div class="navbar">
  <a href="https://extensively.github.io/Projects/index.html">Home</a>
  <a href="https://extensively.github.io/Projects/about.html">About</a>
  <a href="https://extensively.github.io/Projects/memes.html">Memes</a>
  <a href="https://extensively.github.io/Projects/minesweeper.html">Minesweeper</a>
  <a href="https://extensively.github.io/Projects/nathangpt.html">Chat</a>
  <a href="https://extensively.github.io/Projects/snake.html">Snake</a>
  <a href="shape/shape.html" class="rainbowfast">Shapez</a>
</div>
<br>
<br>

  <div id="app">
    <div id="gameArea" style="position:relative;">
  <canvas id="gameCanvas" width="800" height="600"></canvas>

      <!-- Main Menu overlay (canvas-only) -->
      <div id="mainMenu" style="position:absolute; left:0; top:0; width:100%; height:100%; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,0.6); z-index:1300;">
        <div style="background:#111; padding:20px; border:2px solid #444; width:360px; text-align:center; color:#fff;">
          <h2>Shapez</h2>
          <p>Press Play to start</p>
          <button id="mm_play">Play</button>
          <button id="mm_resetSave" style="margin-left:8px;">Reset Save</button>
          <div style="margin-top:12px; font-size:13px; color:#ddd;">Use Esc to Pause</div>
        </div>
      </div>

      <!-- Pause overlay (canvas-only) -->
      <div id="pauseOverlay" style="position:absolute; left:0; top:0; width:100%; height:100%; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,0.6); z-index:1300;">
        <div style="background:#111; padding:18px; border:2px solid #444; width:300px; text-align:center; color:#fff;">
          <h2>Paused</h2>
          <button id="pause_resume">Resume</button>
          <button id="pause_save" style="margin-left:8px;">Save</button>
          <button id="pause_quit" style="margin-left:8px;">Main Menu</button>
        </div>
      </div>

    </div>
    <!-- Stats and Graphs Panel -->
    <div id="radarContainer" style="display:flex; flex-direction:column; align-items:center;">
      <div id="radarPanel" style="width:100%;">
        <div id="graphScrollArea">
          <div style="padding:10px; color:#ffd; font-weight:600;">Player Stats</div>
          <canvas id="radarCanvas" width="260" height="260"></canvas>
          <div id="radarLegend" style="color:#bbb; font-size:12px; padding:6px 10px; text-align:center;">
            SPD · ATK · DMG · HP · DEF · LCK
          </div>
          <div id="weaponRadarPanel" style="margin-top:12px;">
            <div style="padding:10px; color:#ffd; font-weight:600;">Weapon Stats</div>
            <canvas id="weaponRadarCanvas" width="260" height="260"></canvas>
            <div id="weaponRadarLegend" style="color:#bbb; font-size:12px; padding:6px 10px; text-align:center;">
              DMG · SPD · ATK · PIERCE · SPREAD · ANGLE · PDL
            </div>
          </div>
        <h3>Enemy Stat Scaling Graph</h3>
        <canvas id="enemyStatGraph" width="300" height="180"></canvas>

        </div>
      </div>
    </div>

    <aside id="settings">
      <style>
        /* Smooth collapse/expand: we animate max-height */
        .collapsible { overflow: hidden; transition: max-height 220ms ease; }
        /* Responsive graph area and canvases */
        #graphScrollArea { max-height: 600px; overflow-y: auto; width: 100%; padding-right: 8px; }
        #graphScrollArea canvas { width: 100% !important; max-width: 600px; height: auto; display: block; margin: 10px auto; }
        /* Settings header flex row */
        #settingsHeader { display: flex; gap: 6px; align-items: center; margin-bottom: 8px; }
      </style>
      <div id="settingsHeader">
        <button id="expandAll" title="Expand all settings">Expand All</button>
        <button id="collapseAll" title="Collapse all settings">Collapse All</button>
        <button id="toggleSettings">Settings ▸</button>
      </div>
      <div id="settingsBody" class="collapsed">
        <style>
          /* styles for draggable settings sections */
          .settings-section { border-bottom: 1px solid rgba(255,255,255,0.03); padding:6px 0; }
          .settings-section.dragging { opacity: 0.6; }
          .settings-section h3, .settings-section h4 { display:flex; align-items:center; gap:6px; }
          .settings-section h3 span[title], .settings-section h4 span[title] { display:inline-block; }
        </style>

        <h3>Session</h3>
        <div><strong>Seed:</strong> <span id="seedDisplay">-</span></div>
        <h3>Controls</h3>
        <div>Move: A/D or ←/→</div>
        <div>Jump: W or Space</div>
        <div>Shoot: Mouse click</div>
        <div>Cycle weapons: Q</div>


        <h3>World</h3>
        <label>Door spawn chance (per platform):
          <input id="doorSpawnRate" type="number" min="0" max="1" step="0.01" value="0.02" />
        </label>
        <label>Expansion amount:
          <input id="expansionAmount" type="number" min="1" max="150" value="50" />
        </label>
        <label>Wall distance (px):
          <input id="wallDistance" type="number" min="400" max="20000" value="12000" />
        </label>
        <label>
          <input id="infiniteWalls" type="checkbox" checked />
          Enable far walls
        </label>

        <h3>Weapon Stats (selected)</h3>
          <div id="weaponStats">
            <label>Damage: <span id="ws_damage_val">-</span>
              <input id="ws_damage" type="range" min="1" max="20" step="1" value="1" />
            </label>
            <label>Speed: <span id="ws_speed_val">-</span>
              <input id="ws_speed" type="range" min="1" max="40" step="1" value="8" />
            </label>
            <label>Pierce (count): <span id="ws_pierce_val">-</span>
              <input id="ws_pierce" type="range" min="0" max="8" step="1" value="0" />
            </label>
            <label>Pierce Damage Loss: <span id="ws_pdl_val">-</span>
              <input id="ws_pdl" type="range" min="0" max="100" step="1" value="0" />
            </label>
            <label>Spread (bullets): <span id="ws_spread_val">-</span>
              <input id="ws_spread" type="range" min="1" max="9" step="1" value="1" />
            </label>
            <label>Spread Angle (deg): <span id="ws_spread_angle_val">-</span>
              <input id="ws_spread_angle" type="range" min="0" max="90" step="1" value="10" />
            </label>
            <div style="margin-top:6px;">
              <button id="ws_reset">Reset weapon to defaults</button>
              <label style="margin-left:12px;"><input id="showSpread" type="checkbox" checked /> Show spread angle on canvas</label>
            </div>
          </div>
        <h3>Drops</h3>
          <label>Tech drop rate (per enemy)
            <input id="dropRateTech" type="number" min="0" max="1" step="0.01" value="0.02" />
          </label>
          <label>Gun drop rate (per enemy)
            <input id="dropRateGun" type="number" min="0" max="1" step="0.01" value="0.02" />
          </label>
          <div id="dropRatesInfo" style="margin-top:6px; color:#ddd; font-size:13px;">
            Tech drop: <span id="effDropTech">-</span> (base <span id="baseDropTech">0.12</span>)
            &nbsp;&nbsp; Gun drop: <span id="effDropGun">-</span> (base <span id="baseDropGun">0.12</span>)
            <label style="margin-left:12px;"><input id="showRarityOdds" type="checkbox" /> Show rarity odds</label>
          </div>
          <div id="rarityOddsPanel" style="display:none; margin-top:6px; color:#eee; font-size:13px;"></div>
          <h3>Enemies</h3>
          <label>
            Enemy HP formula:
            <input type="text" id="enemyHpFormula" value="6 + 2*x">
          </label>
          <br>
          <label>
            Enemy Speed formula:
            <input type="text" id="enemySpeedFormula" value="1 + 0.05*x">
          </label>
          <br>
          <label>
            Enemy Damage formula:
            <input type="text" id="enemyDmgFormula" value="1 + 0.1*x">
          </label>
          <br>
          <label>
            Enemy Spawn Rate formula:
            <input type="text" id="enemySpawnFormula" value="0.15 + 0.02*x">
          </label>
          
        <h3>Debug Toggles</h3>
          <label><input type="checkbox" id="toggleSpawn" checked /> Spawn Enemies</label>
          <label><input type="checkbox" id="toggleLoot" checked /> Loot Drops</label>
          <label><input type="checkbox" id="toggleDebug" checked /> Show Debug Log</label>
        <h3>Game</h3>
        <div>Lives: <span id="livesDisplay">-</span></div>
        <h3>Platform Generation</h3>
          <label>Chunk size (platforms per batch)
            <input id="gen_chunkSize" type="number" min="1" max="50" value="10" />
          </label>
          <label>Spacing X (px)
            <input id="gen_spacingX" type="number" min="32" max="256" value="96" />
          </label>
          <label>Platform width (px)
            <input id="gen_platWidth" type="number" min="24" max="256" value="88" />
          </label>
          <label>Height base (px)
            <input id="gen_baseY" type="number" min="100" max="600" value="380" />
          </label>
          <label>Height variance (px)
            <input id="gen_varY" type="number" min="0" max="400" value="180" />
          </label>
          <label>Horizontal jitter (px)
            <input id="gen_jitterX" type="number" min="0" max="96" value="48" />
          </label>
          <label>Cluster density (0-1)
            <input id="gen_cluster" type="number" min="0" max="1" step="0.05" value="0.0" />
          </label>

        <h3>Debug</h3>
        <button id="regenSeed">Regenerate Seed</button>
        <button id="toggleChangelog" style="margin-left:12px;">Toggle Changelog</button>
        
        <h3 style="margin-top:12px;">Particles</h3>
        <label>Particle color A: <input id="particleColorA" type="color" value="#ffd066" /></label>
        <label style="margin-left:8px;">Particle color B: <input id="particleColorB" type="color" value="#ff66a0" /></label>
        <div style="margin-top:6px;">
          <label><input id="particleUseTwo" type="checkbox" checked /> Use two colours</label>
        </div>
        <label style="display:block; margin-top:6px;">Particles / hit: <input id="particleAmount" type="number" min="0" max="200" value="12" /></label>
        <label style="display:block;">Particle life (sec): <input id="particleLife" type="number" min="0.05" max="5" step="0.05" value="0.5" /></label>
        <label style="display:block;">Particle size (px): <input id="particleSize" type="number" min="1" max="16" value="2" /></label>
        
        <h3 style="margin-top:12px;">Player Stats</h3>
        <label>Damage (percent over baseline): <span id="ps_damage_val">0%</span>
          <input id="ps_damage" type="range" min="0" max="200" step="1" value="0" />
        </label>
        <label>Attack Speed (percent over baseline): <span id="ps_attack_val">0%</span>
          <input id="ps_attack" type="range" min="0" max="200" step="1" value="0" />
        </label>
        <label>Defence (% damage reduction): <span id="ps_defence_val">0%</span>
          <input id="ps_defence" type="range" min="0" max="95" step="1" value="0" />
        </label>
        <label>Health (max HP boost): <span id="ps_health_val">0</span>
          <input id="ps_health" type="range" min="0" max="300" step="1" value="0" />
        </label>
        <label>Speed (percent over baseline): <span id="ps_speed_val">0%</span>
          <input id="ps_speed" type="range" min="0" max="200" step="1" value="0" />
        </label>
        <label>Luck (percent): <span id="ps_luck_val">0%</span>
          <input id="ps_luck" type="range" min="0" max="100" step="1" value="0" />
        </label>
        <h3 style="margin-top:12px;">HUD Displays</h3>
        <div id="hudToggles">
          <label><input type="checkbox" id="hud_weapon" checked /> Show Weapon</label>
          <label><input type="checkbox" id="hud_tips" checked /> Show Tips</label>
          <label><input type="checkbox" id="hud_techs" checked /> Show Techs</label>
          <label><input type="checkbox" id="hud_seed" checked /> Show Seed</label>
          <label><input type="checkbox" id="hud_floor" checked /> Show Floor</label>
          <label><input type="checkbox" id="hud_platform" checked /> Show Platform Info</label>
          <label><input type="checkbox" id="hud_enemies" checked /> Show Enemies Count</label>
          <label><input type="checkbox" id="hud_stats" checked /> Show Player Stats</label>
          <label><input type="checkbox" id="hud_rerolls" checked /> Show Reroll Bank</label>
        </div>
        <div style="margin-top:8px;">
          <label>Give Rerolls: <input id="giveRerollsInput" type="number" min="0" value="0" style="width:64px;" /> <button id="giveRerollsBtn">Grant</button></label>
        </div>
        <style>
          /* chroma animation for Divine rarity */
          @keyframes chromaCycle { 0%{filter:hue-rotate(0deg)} 50%{filter:hue-rotate(180deg)} 100%{filter:hue-rotate(360deg)} }
          .divine-chroma { position:relative; overflow:hidden; }
          .divine-chroma::before{ content:''; position:absolute; left:-20%; top:-20%; width:140%; height:140%; background: linear-gradient(60deg, #ffd34d, #ff6ec7, #6ef0ff, #9dff7a); mix-blend-mode: screen; opacity:0.95; transform:translateZ(0); animation: chromaCycle 4s linear infinite; }
          .divine-chroma > * { position:relative; z-index:2; }
        </style>
      </div>
    </aside>
    <div id="changelogPanel" style="display:none; position:fixed; right:8px; top:88px; width:340px; height:76%; background:#0b0b0b; color:#ddd; overflow:auto; padding:12px; border:1px solid #333; z-index:1200;">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
        <strong>Changelog</strong>
        <button id="closeChangelog">Close</button>
      </div>
      <pre id="changelogContent" style="white-space:pre-wrap; font-family:monospace; font-size:13px; color:#ddd;">Loading...</pre>
    </div>
    <!-- Removed duplicate fixed-position overlays (we keep the canvas-only overlays inside #gameArea) -->
  </div>
  <script src="game.js"></script>
<div id="debugOutput" style="color: red; position: fixed; top: 10px; right: 10px; z-index: 1000;"></div>
</body>
</html>